<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/>
<title>GLB World v2</title>

<style>
html,body{
  margin:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:#000;
}

/* Canvas MUST be visible */
#c{
  width:100%;
  height:100%;
  display:block;
  background:#ff00ff; /* hot pink = canvas is visible even if WebGL fails */
  touch-action:none;
}

/* Version badge */
#version-badge{
  position:fixed;
  top:10px;
  right:10px;
  z-index:10000;
  padding:6px 10px;
  font:12px system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  color:#fff;
  background:rgba(0,0,0,.8);
  border:1px solid rgba(255,255,255,.3);
  border-radius:999px;
  pointer-events:none;
}

/* HUD */
#hud{
  position:fixed;
  top:10px;
  left:10px;
  z-index:9999;
  font:13px system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  color:#fff;
  background:rgba(0,0,0,.7);
  padding:10px;
  border-radius:10px;
  max-width:calc(100vw - 20px);
}
</style>
</head>

<body>

<div id="version-badge">v2</div>

<div id="hud">
  <div><b>Status</b></div>
  <div id="msg">Booting…</div>
</div>

<canvas id="c"></canvas>

<script src="https://cdn.babylonjs.com/babylon.js"></script>

<script>
const msg = (t)=>document.getElementById("msg").textContent = t;

if (!BABYLON.Engine.isSupported()) {
  msg("WEBGL NOT SUPPORTED. You should still see HOT PINK background.");
  throw new Error("WebGL not supported");
}

const canvas = document.getElementById("c");
const engine = new BABYLON.Engine(canvas, true, {
  preserveDrawingBuffer:true,
  stencil:true
});

engine.onContextLostObservable.add(()=>{
  msg("WEBGL CONTEXT LOST (iOS memory / low power mode)");
});
engine.onContextRestoredObservable.add(()=>{
  msg("WEBGL CONTEXT RESTORED (reload page)");
});

const scene = new BABYLON.Scene(engine);

/* Bright clear color so black screen is impossible */
scene.clearColor = new BABYLON.Color4(0.05, 0.25, 0.25, 1);

/* Camera */
const cam = new BABYLON.UniversalCamera(
  "cam",
  new BABYLON.Vector3(0, 5, -20),
  scene
);
cam.attachControl(canvas, true);
cam.setTarget(BABYLON.Vector3.Zero());

/* Light */
new BABYLON.HemisphericLight(
  "light",
  new BABYLON.Vector3(0,1,0),
  scene
).intensity = 1.2;

/* GIANT PROOF OBJECTS */

/* Grid */
const grid = BABYLON.MeshBuilder.CreateGround(
  "grid",
  { width:2000, height:2000 },
  scene
);
const gridMat = new BABYLON.StandardMaterial("gridMat", scene);
gridMat.wireframe = true;
gridMat.emissiveColor = new BABYLON.Color3(0.2, 0.9, 1.0);
gridMat.diffuseColor = new BABYLON.Color3(0,0,0);
grid.material = gridMat;

/* Cube */
const cube = BABYLON.MeshBuilder.CreateBox(
  "cube",
  { size:12 },
  scene
);
cube.position = new BABYLON.Vector3(0, 8, 30);
const cubeMat = new BABYLON.StandardMaterial("cubeMat", scene);
cubeMat.emissiveColor = new BABYLON.Color3(1, 0.2, 0.2);
cubeMat.diffuseColor = new BABYLON.Color3(0,0,0);
cubeMat.backFaceCulling = false;
cube.material = cubeMat;

/* Rotate cube so motion is undeniable */
scene.onBeforeRenderObservable.add(()=>{
  cube.rotation.y += 0.01;
});

/* Render proof */
let firstFrame = true;
engine.runRenderLoop(()=>{
  scene.render();
  if(firstFrame){
    firstFrame = false;
    msg("RENDERING ✅  You should see teal background + cyan grid + rotating red cube.");
  }
});

/* Resize fix (iOS Safari needs this) */
setTimeout(()=>engine.resize(), 100);
window.addEventListener("resize", ()=>engine.resize());
</script>

</body>
</html>
