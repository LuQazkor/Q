<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Babylon GLB World</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<script src="https://cdn.babylonjs.com/babylon.js"></script>
<script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>

<style>
html, body {
    width: 100%;
    height: 100%;
    margin: 0;
    overflow: hidden;
    background: #000;
}
#ui {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 10;
    color: #0f0;
    font-family: monospace;
}
</style>
</head>

<body>
<div id="ui">
    <input type="file" id="fileInput" accept=".glb,.gltf"><br>
    WASD move · QE up/down · Drag = look
</div>

<canvas id="renderCanvas"></canvas>

<script>
const canvas = document.getElementById("renderCanvas");
const engine = new BABYLON.Engine(canvas, true);

const scene = new BABYLON.Scene(engine);
scene.clearColor = new BABYLON.Color4(0,0,0,1);

const camera = new BABYLON.UniversalCamera("cam",
    new BABYLON.Vector3(0, 1.6, -5), scene);
camera.attachControl(canvas, true);
camera.speed = 0.6;
camera.angularSensibility = 4000;
camera.keysUp.push(87);
camera.keysDown.push(83);
camera.keysLeft.push(65);
camera.keysRight.push(68);

camera.keysUpward.push(69);   // Q/E vertical flight
camera.keysDownward.push(81);

const light = new BABYLON.HemisphericLight("h",
    new BABYLON.Vector3(0,1,0), scene);
light.intensity = 1.2;

let currentMeshes = [];

function frameMeshes(meshes) {
    const min = new BABYLON.Vector3(Infinity,Infinity,Infinity);
    const max = new BABYLON.Vector3(-Infinity,-Infinity,-Infinity);

    meshes.forEach(m=>{
        if(!m.getBoundingInfo) return;
        const b = m.getBoundingInfo().boundingBox;
        min.minimizeInPlace(b.minimumWorld);
        max.maximizeInPlace(b.maximumWorld);
    });

    const center = min.add(max).scale(0.5);
    const size = max.subtract(min).length();

    camera.position = center.add(new BABYLON.Vector3(0, size * 0.2, -size));
    camera.setTarget(center);
}

document.getElementById("fileInput").addEventListener("change", e=>{
    const file = e.target.files[0];
    if(!file) return;

    currentMeshes.forEach(m=>m.dispose());
    currentMeshes = [];

    BABYLON.SceneLoader.LoadAsync(
        "file:",
        file,
        scene
    ).then(result=>{
        currentMeshes = result.meshes;
        frameMeshes(currentMeshes);
    });
});

engine.runRenderLoop(()=>scene.render());
window.addEventListener("resize", ()=>engine.resize());
</script>
</body>
</html>